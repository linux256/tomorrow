\newpage

## MANAGE USERS AND GROUPS
# 49. Change password and adjust password aging for local user accounts

---

### I. FICHEROS DEFINICION

`/etc/shadow`

> Contiene 5 valores referentes a fechas de las contraseñas (`man 5 shadow`),
(*login: passwordEncrypted: lastChange: MINAGE: MAXAGE: WARN: INAC: ACCEXP:
reserv*):

> **referentes a que la contraseña expire**

> * `minAge` duración mínima requerida de la contraseña (p.defecto: 0)
> * `maxAge` duración máxima de una contraseña para que expire (p.d: 99999)
> * `warnPeriod` periodo de aviso antes de que expire (p.d: -)

> **referentes a que la cuenta se deshabilite**

> * `inactivityPeriod` dias posteriores a que la contraseña expire antes de que
la cuenta sea deshabilitada (por tanto durante los cuales la contraseña se
acepta y el usuario puede cambiarla al hacer login (p.d: -)
> * `accountExpirationDate` fecha en que la cuenta se deshabilita, NO la
contraseña


`/etc/login.defs`

> Parametros de login, de los cuales **referentes a que la contraseña expire**,

> * `PASS_MIN_DAYS`  Duración mínima requerida de una contraseña
> * `PASS_MAX_DAYS`  Duración máxima posible para que una contraseña expire
> * `PASS_WARN_AGE`  Dias previos de aviso a que una contraseña expire

`/etc/default/useradd`

> Parametros por defecto para el comando `useradd`, de los cuales **referentes a
que la cuenta se deshabilite**,

> * `INACTIVE` The number of days after a password expires until the account is
permanently disabled. A value of 0 disables the account as soon as the password
has expired, and a value of -1 disables the feature. Por defecto, `-1`

> * `EXPIRE` Fecha en que la cuenta se deshabilita. Por defecto ` `

### II. PASSWD [EX200]

`passwd -n30  -x90  -w3 usuario`

> Fija que la contraseña tenga una validez minima de 30 días, un máximo de 90 y
un previso de 3 antes de que expire.

`passwd -e usuario`

> Fuerza que la contraseña del usuario haya expirado

`passwd -l usuario`

> Bloquea una contraseña anteponiéndole `!!` en la contraseña cifrada, Esto NO
bloquea por completo una cuenta, el usuario puede iniciar sesión mediante SSH
empleando clave pública

`passwd -u usuario`

> Desbloquea una contraseñam eliminando `!!` de la contraseña cifrada

`passwd -d usuario`

> Borra la contraseña de un usuario, incluido que pudiera estar bloqueada. Esto
permite que el usuario haga login sin contraseña en consola local, no mediante
SSH. Para permitir login con SSH y contraseña vacía se debe incluir el parámetro
`PermitEmptyPasswords yes` en /etc/ssh/sshd_config`


### III. CHAGE [EX200]

`chage usuario`

> El comando `chage` permite modificar la informacion referente a la expiración
de la contraseña de un usuario y la informacion referente a la fecha para
deshabilitar una cuenta. Va preguntando todos los parámetros de manera guiada.

`chage -l usuario`

> Presenta la información de cuando se ha cambiado y expira una cuenta, y cuando
queda deshabilitada una cuenta.

`chage  -m30  -M90  -W3  usuario`

> Fija un mínimo de 30 días, un máximo de 90 días y un preaviso de 3.

`chage -E yyyy-mm-dd usuario`

> Establece fecha en que se deshabilita una cuenta (o -1 para no deshabilitarla)


