\newpage

## CONFIGURE LOCAL STORAGE
# 27. Create and remove physical volumes

---

### I. LVM BASICS

Logical Volume Manager es una herramienta de gestion de almacenamiento lógico
integrada en el kernel de Linux, que funciona con una estructura multicapa,

* `physical devices`
* `L1 - PHYSICAL VOLUMES` 
* `L2 - VOLUME GROUP`
* `L3 - LOGICAL VOLUME`
* `filesystem`

Para su uso con LVM, los dispositivos físicos deben prepararse, marcando sus
particiones de tipo LVM (`8e` en discos con particionbado MBR, `8e00` en discos
con particionado GPT). Para ello se emplea `fdisk`, `gdisk` o `parted`


### II. PHYSICAL VOLUMES

`pvcreate /dev/vdb1/`

> Escribe metadatos en la partición `/dev/vdb1` que permiten su empleo por LVM.
> Aunque LVM puede crear PV sobre discos completos NO se recomienda hacer esto
> encarecidamente. Además, *es preferible emplear una única partición por disco*
> en lugar de tener múltiples particiones en un disco, en base a estos motivos,

1. Para administrar el almacenamiento, es más sencillo que cada disco solo
aparezca una vez, lo que se logra si solo hay una partición por disco. Esto es
especialmente relevante si el disco falla.
2. El empleo de multiples PVs en un mismo disco puede producir un warning del
kernel sobre particiones desconocidas en el arranque
3. Si no se define una partición en el disco, aunque LVM puede manejarlo, otros
sistemos operativos no reconoceran los metadatos como LVM y pueden informar que
el disco está vacío haciendo probable su sobreescritura
4. No particionar un disco no añadirá el tipo 8e/8e00 en ninguna particion lo
que dificulta entender el uso que se hace del disco

`pvs`

> Información resumida de los PV

`pvdisplay /dev/nvm0n1p3`

> Información detallada del PV indicado, o de todos si no es especifica ninguno.
> Es de interes conocer el `PE Size`, o *physical extent size* por defecto 4MiB
> que será la unidad mínima de almacenamiento direccionable con LVM, operando
> en cantidades discretas de *physical extents*


