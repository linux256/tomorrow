\newpage

## DEPLOY CONFIGURE AND MAINTAIN SYSTEMS
# 43. Modify the system bootloader

---

### I. GRUB2 (Grand Unified Bootloader) v2

Bootloader estándar en Linux. Se divide en varias etapas segun el medio de
almacenamiento donde esté. La primera etapa está en el sector de arranque MBR
del disco (LBA0) y de ahí salta a las siguientes etapas. La función de GRUB es
ejecutar el **kernel** junto a **initramfs**. El **kernel** permite que los
usuarios (shell) interactuen con el hardware. El **initramfs** incluye drivers
y utilidades necesarias para que el kernel inicie el equipo.

**`/etc/default/grub`**

> opciones de configuración de GRUB2 (mas info: `info grub2 -n "Simple
configuration"`), como `GRUB_CMDLINE_LINUX="crashkernel=... resume=... `
`rd.lvm.lv=rhel/root rd.lvm.lv=rhel/swap"` y `GRUB_ENABLE_BLSCFG=true`

`/etc/grub.d/`

> Scripts que detallan que cargar y como hacerlo

### II. GRUB2 MAIN CONFIGURATION FILE [EX200]

`/boot/grub2/grub.cfg            # firmware BIOS`  
`/boot/efi/EFI/redhat/grub.cfg   # firmware UEFI`  

> Fichero de configuracion principal de GRUB, su ubicación depende del tipo de
firmware.

`/sys/firmaware/efi/`

> Si este directorio existe, el sistema se ha iniciado con UEFI

El fichero de configuración principal **`grub.cfg`** usa tres componentes,

1. fichero de opciones **`/etc/default/grub`**
2. scripts **`/etc/grub.d/`**
3. comando **`grub2-mkconfig`**, que usa STDOUT y con (`-o`) vuelca a fichero.
RHEL 9.3 y superior usan `--update-bls-cmdline` para guardar opciones de inicio
del kernel. Según BIOS o UEFI el comando es:

> **`grub2-mkconfig   --update-bls-cmdline   -o /boot/grub2/grub.cfg`**  
> **`grub2-mkconfig   --update-bls-cmdline   -o /boot/efi/EFI/redhat/grub.cfg`**

`man 7 bootparam`

> Información de los parámetros de arranque del Kernel

### III. UTILIDADES ADICIONALES

**`grub2-script-check   /boot/efi/EFI/redhat/grub.cfg`**

> Chequea la sintáxis, *solo la sintáxis*, del Main Configuracion File de GRUB2

`grub2-editenv list`

> lista variables referentes al menu GRUB2 (entrada guardada, auto_hide,...)

`grub2-editenv - unset menu_auto_hide`

> Desactiva la funcionalidad de auto ocultamiento del menu de GRUB2

**`grubby --info=ALL`**

> Muestra información de todas las opciones de arranque del menú GRUB

`grub2-reboot 3`

> Establece que en el siguiente arranque, *solo el siguiente*, se use opción 3

`grub2-set-default`

> Establece opción de arranque por defecto


