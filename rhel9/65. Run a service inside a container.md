\newpage

## MANAGE CONTAINERS
# 65. Run a service inside a container

---

### I. EJECUTAR UN SEGUNDO COMANDO EN EL CONTENEDOR

`podman exec  nameCont  cmd`

> Ejecuta el comando `cmd` en `nameCont`, que debe estar en ejecución. Es una
manera de ejecutar un segundo comando en el contenedor.

**`podman exec -it  miWeb /bin/bash`**

> Ejecuta el comando `/bin/bash` de manera interactiva en el contenedor 'miWeb'
, con lo que se consigue un shell habitualmente para iniciar/detener servicios.
*Un `exit` abandona el segundo comando `/bin/bash` pero el contenedor sigue en
ejecución*

>

### II. MODIFICACION DE PUERTOS DEL CONTENEDOR. EJECUCION PRIVILEGIADA

`podman run  --name web  -d  -p 8080:80  nginx`

> Ejecuta contenedor `nginx` *rootless* con nombre (`--name`) `web`, en segundo
plano (`-d`) y haciendo el servicio accesible en el puerto no privilegiado 8080
del host. Para mapear a un puerto *privilegiado* (1-1024) se debe ejecutar con
`sudo podman run...`, es decir que debe ser un *root container* 

`podman run --privileged -it nameCont`

> Ejecuta contenedor con un perfil privilegiado

`podman run --cap-add NET_RAW -it nameCont`

> Ejecuta el contenedor añadiéndole la capacidad de poder crear un socket RAW
necesario para poder ejecutar, por ejemplo, `nmap` (para `ping` no se necesita
porque se emplea ICMP Echo sockets que los pueden crear los usuarios de los 
grupos establecidos en el kernel, ver:  `sysctl net.ipv4.ping_group_range`)

### III. VARIABLES DE ENTORNO EN EL CONTENEDOR

`podman  logs  nameCont`

> Muestra logs de `nameCont` como errores por falta de variables definidas

`podman inspect  nameCont | grep usage`

> Busca información sobre el uso inspeccionando la imagen descargada

```
podman run -d  -e MYSQL_USER=bob           \
.              -e MYSQL_PASSWORD=password  \
.              -e MYSQL_DATABASE=mydb      \
.              -e MYSQL_ROOT_PASSWORD=pass \
.              -p 3306:3306                \
.               registry.redhat.io/rhel9/mariadb-105
```

> Ejecuta contenedor `mariadb` con 4 variables de entorno definidas (`-e`)
y manteniendo el puerto del contenedor hacia el host


