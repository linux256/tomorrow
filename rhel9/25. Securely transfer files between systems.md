\newpage

## OPERATE RUNNING SYSTEMS
# 25. Securely transfer files between systems

---

### I. SECURE COPY (SCP) Y SECURE FILE TRANSFER PROTOCOL (SFTP)

**`scp  -r  -P 25  usuario@serv_origen:ruta_origen  destino`**

* `-r` copia recursivamente
* `-P` establece el puerto si es distinto a 22
* `usuario@serv_origen:ruta_origen` origen de los datos a copiar, puede ser una
ruta local o remota
* `destino` destino donde se copiarán los datos, puede ser ruta local o remota

>

**`sftp  usuario@servidor_remoto`**

> cliente SFTP ejecutado contra un servidor remoto `sshd` para mover fichero
> con comandos como,

* `ls`, `pwd` muestra contenido remoto, muestra working directory remoto
* `lcd`, `lpwd` cambia directorio local, muestra working directory local
* `put`, `get` copia de local a remoto, copia de remoto a local
* `exit` cierra la conexión


### II. REMOTE SYNC (RSYNC)

**`rsync -a  --delete  origen  destino`**

* `-a` archivar, equivalente a:

> * `-r` recursivo
> * `-l` copia enlaces simbólicos
> * `-p` mantiene permisos
> * `-t` mantiene fecha de modificacioń
> * `-o` mantiene propietario
> * `-g` mantiene grupo propietario
> * `-D` copia ficheros especiales

* `--delete` borra en destino lo que no existe en origen (crea un clon del
contenido origen en destino)
* `origen` si se emplea `origen` el contenido queda en `destino/origen/...`
Si se emplea **`origen/`** el contenido queda en **`destino/...`**

`rsync -auUNAX -n -v ...`

* `-u` solo realiza *update* de los archivos nuevos
* `-n` realiza *dry-run*, solo muestra lo que haría, no ejecuta nada
* `-v` *verbose* 
* `-N` mantiene fecha de creación, **no soportado en Linux**
* `-U` mantiene fecha de acceso
* `-A` copia ACL
* `-X` copia contexto SELinux


