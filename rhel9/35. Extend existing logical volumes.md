\newpage

## CREATE AND CONFIGURE FILESYSTEMS
# 35. Extend existing logical volumes

---

### I. AMPLIAR Y REDUCIR VOLUME GROUPS

`vgextend VGNAME   PVNAME`

> Amplia el *volume group* `VGNAME ` añadiéndole el *physical volume* `PVNAME`

`pvmove   PVORIGEN PVDESTINO`

> Libera `PVORIGEN` moviendo sus *physcial extents* a `PVDESTINO`

`vgreduce VGNAME   PVNAME`

> Reduce `VGNAME` retirándole el *physical volume* `PVNAME`

### II. MODIFICACION DEL TAMAÑO DE LOGICAL VOLUMES

`lvresize  -r  -L +1G        /dev/VG01/LV01   [PV01]`

> Intenta añadir 1GiB de espacio al *logical volume* LV01. Con `-r` intenta
> modificar también el tamaño del *filesystem* contenido, lo que es la opción
> recomendada. Si se indica `PV01` intenta añadir los *physical extents* de
> ese disco.

`lvresize  -r  -l 75% VG     /dev/VG01/LV01   [PV01]`

> Intenta cambiar el tamaño de `LV01` para que sea el 75% del tamaño de `VG`,
> esto puede suponer intentar reducir el tamaño del volumen lógico, no el del
> *filesystem* contenido aunque se emplea `-r`. Si se indica `PV01` intenta
> añadir el espacio de ese disco.

`lvresize  -r  -l +75% VG    /dev/VG01/LV01   [PV01]`

> Intenta añadir a `LVNAME` el 75% del tamaño de `VG01` no asignado (libre).
> Si se indica `PV01` intenta añadir el espacio de ese disco.

`lvresize  -r  -l 75% FREE   /dev/VG01/LV01   [PV01]`

> Intenta cambiar el tamaño de `LV01` para que sea el 75% del espacio tiral de
> de `VG01`, que no debe estar asignado, intentando emplear *physical extents*
> de `PV01`

`lvresize  -r  -l +75% FREE  /dev/VG01/LV01   [PV01]`

> Intenta ampliar el tamaiño de `LV01` añadiendo el 75% del espacio no asignado
> (libre) de `VG01` intentando emplear *physical extents* de `PV01`

`lvextend`

> Extiende un volumen lógico, de manera similar a `lvresize` que es la manera
> recomendada.

### III. STRATIS

**Stratis** es un sistema de gestión de almacenamiento multicapa, donde se parte
de un conjunto de dispositivos de bloques (todos *thick-provisioned*) para 
construir un **pool** `/dev/stratis/poolname` del cual se crearán un conjunto
de *filesystems* siempre *thin-provisioned*. Para montar, se requiere iniciado
el servicio `stratisd`

```
dnf install stratisd stratis-cli
systemctl enable --now stratisd
stratis blockdev

stratis pool create mypool /dev/sdc     # PRIMERO -- p o o l   c r e a t e
stratus pool list
stratis fs   create mypool fsstr1       # SEGUNDO --     f s   c r e a t e
stratus fs   list
```

`/etc/fstab                              # TERCERO --   fstab   o p t i o n s`

> `UUID="xxxx"   /mnt  xfs   defaults,x-systemd.requires=stratisd.service 0 0`


