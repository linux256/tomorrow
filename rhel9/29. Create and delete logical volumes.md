\newpage

## CONFIGURE LOCAL STORAGE
# 29. Create and delete logical volumes

---

### I. COMANDOS SOBRE LOGICAL VOLUMES

`lvcreate  -n NOMBRELV  -l 100  NOMBREVG`

> Crea un LV nuevo, con nombre `NOMBRELV` con 100 *physical extents* procedentes
> del VG `NOMBREVG` al que pertenecerá

`lvcreate  -n NOMBRELV  -l 50%FREE  NOMBREVG`

> Crea un LV con el 50% del espacio libre del VG `NOMBREVG` al que pertenecerá

`lvcreate  -n NOMBRELV  -L 5G  NOMBREVG`

> Crea un LV con un tamaño de 5GiB en el VG `NOMBREVG` al que pertenecerá

`lvs`

> Muestra información resumida de todos los LV

`lvdisplay  NOMBRELV`

> Muestra información detalla del LV `NOMBRELV`

>

### II. LOGICAL VOLUMES CON FUNCIONES AÑADIDAS. STRIPES Y SNAPSHOTS

`lvcreate  -n NOMBRELV  -L 1G  -i 4  -I 64k   NOMBREVG`

> Crea un LV de 1GiB repartiendo las operaciones de I/O en bloques de 64k entre
> 4 dispositivos (`-i 4` stripes = 4,  `-I 64k` stripe size = 64 KiB). El VG 
> debe tener 4 PV. El tamaño de cada stripe no puede superar el PE size de los
> PV.

`lvcreate  -s -n LVSNAP  -l100%FREE   NOMBRELV`

> Crea un LV nuevo `LVSNAP` para generar un snapshot COW del LV `NOMBRELV` con
> el 100% del espacio libre del VG de NOMBRELV

>

### III. NOMBRES DE DISPOSITIVOS ASIGNADOS A LOS LOGICAL VOLUMES CREADOS

`/dev/dm-0`

`/dev/dm-1`

> Nombres de los dispositivos reales creados por Device Mapper

`/dev/mapper/NOMBREVG-NOMBRELV`

> Enlace simbólico al dispositivo DM (por ejemplo `/dev/dm-2`)

`/dev/NOMBREVG/NOMBRELV` 

> Enlace simbólico al dispositivo DM (por ejemplo `/dev/dm-1`). Una vez creado
> el filesystem en el LV **se empleará este nombre en `/etc/fstab`**

### IV. RESUMEN DE COMANDOS LVM

| PHYSICAL VOLUMES | VOLUME GROUPS | LOGICAL VOLUMES |
|------------------|---------------|-----------------|
| `pvcreate`       | `vgcreate`    | `lvcreate`      |
| `pvremove`       | `vgremove`    | `lvremove`      |
| `pvs`            | `vgs`         | `lvs`           |
| `pvdisplay`      | `vgdisplay`   | `lvdisplay`     |


---

*Referencias*

* https://medium.com/@ahmedmansouri/boosting-linux-disk-performance-with-lvm-striping-06f0124663ba

* https://tldp.org/HOWTO/LVM-HOWTO/snapshotintro.html

* https://www.thomas-krenn.com/en/wiki/LVM_Snapshots_Information#cite_note-4


